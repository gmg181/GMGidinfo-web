<!-- chat.html -->
<!DOCTYPE html>
<html>
<head>
  <title>Chat</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
  <h2>Chat with <span id="chatWith">PlayerName</span></h2>
  <div id="chatBox" style="height:300px; overflow-y:scroll; border:1px solid #ccc;"></div>
  <input type="text" id="msgInput" placeholder="Type your message...">
  <button onclick="sendMessage()">Send</button>

  <script>
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const currentUID = "user123"; // यह यूज़र की UID है (लॉगिन के बाद सेट करें)
    const chattingWithUID = "user456"; // जिस से चैट कर रहे हैं

    const chatRoomId = currentUID < chattingWithUID 
                       ? currentUID + "_" + chattingWithUID 
                       : chattingWithUID + "_" + currentUID;

    function sendMessage() {
      const msg = document.getElementById("msgInput").value;
      db.ref("chats/" + chatRoomId).push({
        sender: currentUID,
        message: msg,
        timestamp: Date.now()
      });
      document.getElementById("msgInput").value = "";
    }

    db.ref("chats/" + chatRoomId).on("child_added", function(snapshot) {
      const data = snapshot.val();
      const msgElem = document.createElement("div");
      msgElem.innerHTML = `<b>${data.sender}:</b> ${data.message}`;
      document.getElementById("chatBox").appendChild(msgElem);
    });
  </script>
</body>
</html>
