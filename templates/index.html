<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>FREE FIRE VAULT</title>
  <meta name="author" content="GMG & CLOUD" />
  <meta name="description" content="Search Free Fire items by name or description to get ID, rarity, type and more." />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root {
      --bg:#0d0f12; --panel:#111418; --muted:#1b1f24; --text:#e8eaed; --sub:#b3b7bd; --brand:#7c5cff; --accent:#2a2f36; --card:#14181d;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Noto Sans",sans-serif;background:var(--bg);color:var(--text)}
    /* header */
    .header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,#0d0f12,#0d0f12d0 70%,#0d0f1200);backdrop-filter:saturate(160%) blur(6px);border-bottom:1px solid #111}
    .header-wrap{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;gap:8px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700;font-size:18px;letter-spacing:.4px}
    .brand i{color:var(--brand)}
    .menu-btn{font-size:18px;padding:8px;border-radius:12px;background:var(--muted);border:1px solid #20262c;cursor:pointer}
    .menu-btn:hover{filter:brightness(1.1)}
    /* search (top) */
    .main-search{display:flex;align-items:center;gap:8px;padding:10px 14px;background:var(--panel);border-bottom:1px solid #12161a}
    .search-input{flex:1;height:40px;border-radius:12px;border:1px solid #22262c;background:#0f1216;color:var(--text);padding:8px 12px;resize:none}
    .search-icon{color:#cfd3da}
    /* layout */
    .layout{display:grid;grid-template-columns:280px 1fr;gap:0}
    @media (max-width: 960px){.layout{grid-template-columns:1fr}}
    /* sidebar */
    .sidebar{background:var(--panel);border-right:1px solid #12161a;min-height:calc(100dvh - 110px)}
    .side-block{padding:12px 14px;border-bottom:1px solid #12161a}
    .side-title{display:flex;align-items:center;justify-content:space-between;font-weight:600;margin-bottom:8px}
    .chipbar{display:flex;flex-wrap:wrap;gap:8px}
    .chip{padding:6px 10px;border-radius:999px;background:var(--muted);border:1px solid #20262c;color:#d9dde3;font-size:12px;cursor:pointer}
    .chip.active{background:var(--brand);border-color:#6c4bff;color:white}
    .filters-row{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
    select{background:#0f1216;color:var(--text);border:1px solid #22262c;border-radius:10px;padding:8px}
    /* filter tabs */
    .tabs{display:flex;flex-wrap:wrap;gap:8px;padding:10px 14px;border-bottom:1px solid #12161a;background:#0f1216}
    .tab{display:flex;align-items:center;gap:6px;background:var(--accent);padding:6px 10px;border-radius:999px;font-size:12px;border:1px solid #20262c}
    .tab button{background:transparent;border:none;color:inherit;cursor:pointer}
    /* grid */
    .content{padding:14px}
    .grid{display:grid;grid-template-columns:repeat(6,minmax(0,1fr));gap:12px}
    @media (max-width: 1200px){.grid{grid-template-columns:repeat(5,1fr)}}
    @media (max-width: 960px){.grid{grid-template-columns:repeat(4,1fr)}}
    @media (max-width: 720px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media (max-width: 520px){.grid{grid-template-columns:repeat(2,1fr)}}
    .card{background:var(--card);border:1px solid #1a1f26;border-radius:16px;overflow:hidden;cursor:pointer;transition:transform .12s ease, box-shadow .12s ease}
    .card:hover{transform:translateY(-2px);box-shadow:0 8px 30px #0000003a}
    .thumb{aspect-ratio:1/1;background:#0a0d10;display:flex;align-items:center;justify-content:center}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .meta{padding:10px}
    .name{font-weight:600;font-size:14px;line-height:1.3}
    .muted{color:var(--sub);font-size:12px}
    .pill{display:inline-block;margin-top:6px;font-size:10px;background:#171b20;border:1px solid #20262c;border-radius:999px;padding:4px 8px}
    /* pagination */
    .pagination{display:flex;justify-content:center;gap:6px;padding:16px}
    .page-btn{background:#10141a;border:1px solid #22262c;color:#d9dde3;padding:8px 12px;border-radius:10px;cursor:pointer}
    .page-btn.active{background:var(--brand);border-color:#6c4bff;color:white}
    /* modal */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:#000000c0;z-index:50}
    .modal.open{display:flex}
    .modal-card{background:#0f1216;border:1px solid #1a1f26;border-radius:18px;max-width:960px;width:min(92vw,960px);display:grid;grid-template-columns:1fr 1fr;overflow:hidden}
    @media (max-width: 820px){.modal-card{grid-template-columns:1fr}}
    .modal-img{position:relative;background:#0b0e12}
    .modal-img img{width:100%;height:100%;object-fit:cover}
    .credit{position:absolute;bottom:10px;right:10px;background:#00000080;color:#fff;font-size:12px;padding:4px 8px;border-radius:6px;pointer-events:none}
    .modal-body{padding:14px}
    .row{margin:8px 0}
    .close{margin-top:10px;width:100%;background:var(--brand);color:#fff;border:none;border-radius:12px;padding:10px 12px;font-weight:600;cursor:pointer}
    /* tiny loader */
    .loading-dot{position:fixed;bottom:14px;left:14px;width:10px;height:10px;background:var(--brand);border-radius:50%;box-shadow:0 0 0 0 rgba(124,92,255,.7);animation:pulse 1.4s infinite}
    @keyframes pulse{0%{box-shadow:0 0 0 0 rgba(124,92,255,.6)}70%{box-shadow:0 0 0 14px rgba(124,92,255,0)}100%{box-shadow:0 0 0 0 rgba(124,92,255,0)}}
  </style>
</head>
<body>
  <div class="loading-dot" id="loadingDot" title="Loading..."></div>
  <header class="header">
    <div class="header-wrap">
      <div class="brand"><i class="fa-solid fa-vault"></i> FREE FIRE VAULT</div>
      <button class="menu-btn" id="toggleSidebar" aria-label="Toggle Filters"><i class="fa-solid fa-sliders"></i></button>
    </div>
  </header>

  <!-- top search -->
  <div class="main-search">
    <i class="fa-solid fa-magnifying-glass search-icon"></i>
    <textarea id="searchMain" class="search-input" placeholder="Search by item name, description, ID or icon... (@helmet, #123, +bundle)"></textarea>
  </div>

  <div class="layout">
    <!-- sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="side-block">
        <div class="side-title">Search</div>
        <textarea id="searchSide" class="search-input" placeholder="Type to filter..."></textarea>
      </div>

      <div class="side-block">
        <div class="side-title">Rarity <span class="muted" id="rarityCount"></span></div>
        <div class="chipbar" id="rarityChips"></div>
      </div>

      <div class="side-block">
        <div class="side-title">Item Types</div>
        <div class="chipbar" id="typeChips"></div>
      </div>

      <div class="side-block">
        <div class="side-title">Collections</div>
        <div class="chipbar" id="collectionChips"></div>
      </div>

      <div class="side-block">
        <div class="side-title">Sort</div>
        <div class="filters-row">
          <select id="sortSelect">
            <option value="relevance">Relevance</option>
            <option value="name_asc">Name A→Z</option>
            <option value="name_desc">Name Z→A</option>
            <option value="rarity">Rarity (high→low)</option>
            <option value="newest">Newest (ID high)</option>
          </select>
          <select id="pageSize">
            <option value="24">24 / page</option>
            <option value="36">36 / page</option>
            <option value="60">60 / page</option>
            <option value="96">96 / page</option>
          </select>
        </div>
      </div>
    </aside>

    <!-- main content -->
    <main>
      <div class="tabs" id="activeTabs"></div>
      <section class="content">
        <div class="grid" id="grid"></div>
        <div class="pagination" id="pagination"></div>
      </section>
    </main>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-card">
      <div class="modal-img">
        <img id="modalImg" alt="Preview" />
        <div class="credit">Credit: GMG</div>
      </div>
      <div class="modal-body">
        <div class="row"><strong id="mName"></strong></div>
        <div class="row muted" id="mDesc"></div>
        <div class="row">
          <div class="pill"><b>ID:</b> <span id="mId"></span></div>
          <div class="pill"><b>Icon:</b> <span id="mIcon"></span></div>
        </div>
        <div class="row"><span class="pill" id="mType"></span> <span class="pill" id="mRare"></span> <span class="pill" id="mColl"></span></div>
        <button class="close" id="closeModal">Tap to close</button>
      </div>
    </div>
  </div>

  <!-- Demo data (replace with your own or load from /assets/items.json) -->
  <script id="items-json" type="application/json">{
    "items": [
      {"id": 30123, "name": "Shadow Striker Bundle", "desc": "Stealth bundle with dark accents.", "icon": "icon_bundle_shadow.png", "image":"https://picsum.photos/seed/ff1/800/800", "type": "Bundle", "rarity": "Legendary", "collection": "Event"},
      {"id": 18045, "name": "Crimson Katana", "desc": "A blade forged in flame.", "icon": "wpn_katana_07.png", "image":"https://picsum.photos/seed/ff2/800/800", "type": "Melee", "rarity": "Epic", "collection": "Weapon"},
      {"id": 12009, "name": "Volt MP40", "desc": "Electric MP40 skin.", "icon": "wpn_mp40_volt.png", "image":"https://picsum.photos/seed/ff3/800/800", "type": "Gun Skin", "rarity": "Rare", "collection": "Weapon"},
      {"id": 41022, "name": "Phoenix Backpack", "desc": "Rises from the ashes.", "icon": "bp_phoenix.png", "image":"https://picsum.photos/seed/ff4/800/800", "type": "Backpack", "rarity": "Uncommon", "collection": "Cosmetic"},
      {"id": 51077, "name": "Neon Warrior Mask", "desc": "Glows in the night.", "icon": "mask_neon.png", "image":"https://picsum.photos/seed/ff5/800/800", "type": "Mask", "rarity": "Mythic", "collection": "Cosmetic"},
      {"id": 22011, "name": "Aurora Parachute", "desc": "Paint the sky.", "icon": "para_aurora.png", "image":"https://picsum.photos/seed/ff6/800/800", "type": "Parachute", "rarity": "Common", "collection": "Cosmetic"},
      {"id": 32055, "name": "Cyber Hoodie", "desc": "Street tech wear.", "icon": "hood_cyber.png", "image":"https://picsum.photos/seed/ff7/800/800", "type": "Top", "rarity": "Epic", "collection": "Apparel"},
      {"id": 33056, "name": "Cyber Pants", "desc": "Matching pants.", "icon": "pants_cyber.png", "image":"https://picsum.photos/seed/ff8/800/800", "type": "Bottom", "rarity": "Epic", "collection": "Apparel"}
    ]
  }</script>

  <script>
    // ------- Utilities -------
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    const state = {
      q: '',
      filters: { rarity: new Set(), type: new Set(), collection: new Set() },
      sort: 'relevance',
      page: 1,
      pageSize: 24,
      data: []
    };

    const rarityOrder = ['Common','Uncommon','Rare','Epic','Legendary','Mythic'];
    const rarityRank = r => rarityOrder.indexOf(r) >= 0 ? rarityOrder.indexOf(r) : -1;

    function loadData(){
      try{
        const json = JSON.parse(document.getElementById('items-json').textContent);
        state.data = json.items || [];
      }catch(e){
        console.error('Invalid items JSON', e);
        state.data = [];
      }
    }

    function syncSearchBoxes(){
      const a = document.getElementById('searchMain');
      const b = document.getElementById('searchSide');
      const onA = () => { b.value = a.value; state.q = a.value.trim(); state.page=1; render(); }
      const onB = () => { a.value = b.value; state.q = b.value.trim(); state.page=1; render(); }
      a.addEventListener('input', onA); b.addEventListener('input', onB);
    }

    function buildChips(){
      const by = (key) => Array.from(new Set(state.data.map(x=>x[key]).filter(Boolean))).sort((a,b)=>a.localeCompare(b));
      const make = (arr, container, key) => {
        container.innerHTML = '';
        arr.forEach(v=>{
          const chip = document.createElement('button');
          chip.className = 'chip';
          chip.textContent = v;
          chip.dataset.value = v;
          chip.addEventListener('click', ()=>{
            const set = state.filters[key];
            if(set.has(v)) set.delete(v); else set.add(v);
            state.page=1; render();
          });
          container.appendChild(chip);
        })
      }
      make(by('rarity'), document.getElementById('rarityChips'), 'rarity');
      make(by('type'), document.getElementById('typeChips'), 'type');
      make(by('collection'), document.getElementById('collectionChips'), 'collection');
      document.getElementById('rarityCount').textContent = `(${by('rarity').length})`;
    }

    function applyActiveChipStyles(){
      for(const [key,set] of Object.entries(state.filters)){
        $$('#'+key+'Chips .chip').forEach(ch=>{
          ch.classList.toggle('active', set.has(ch.dataset.value));
        })
      }
    }

    function buildSortAndPage(){
      const sortSelect = document.getElementById('sortSelect');
      const pageSize = document.getElementById('pageSize');
      sortSelect.value = state.sort;
      pageSize.value = String(state.pageSize);
      sortSelect.onchange = () => { state.sort = sortSelect.value; state.page=1; render(); };
      pageSize.onchange = () => { state.pageSize = +pageSize.value; state.page=1; render(); };
    }

    function activeTabs(){
      const tabs = document.getElementById('activeTabs');
      tabs.innerHTML = '';
      const addTab = (label, onClear) => {
        const el = document.createElement('div');
        el.className = 'tab';
        el.innerHTML = `<span>${label}</span> <button title="Clear">✕</button>`;
        el.querySelector('button').onclick = onClear;
        tabs.appendChild(el);
      }
      if(state.q) addTab(`Search: "${state.q}"`, ()=>{ state.q=''; $('#searchMain').value=''; $('#searchSide').value=''; state.page=1; render(); });
      for(const [key,set] of Object.entries(state.filters)){
        set.forEach(v=> addTab(`${key}: ${v}`, ()=>{ set.delete(v); state.page=1; render(); }));
      }
      if(!tabs.children.length){ tabs.innerHTML = '<span class="muted">No filters applied</span>'; }
    }

    function tokenize(str){
      const s = str.toLowerCase();
      const tokens = s.split(/\s+/).filter(Boolean);
      const tags = { id:null, icon:null };
      // mini tag search: #123, @icon.png, +bundle
      const special = s.match(/([#@+])([^\s]+)/g) || [];
      special.forEach(tok=>{
        if(tok.startsWith('#')) tags.id = tok.slice(1);
        if(tok.startsWith('@')) tags.icon = tok.slice(1);
      });
      return { tokens, tags };
    }

    function searchAndFilter(){
      const { tokens, tags } = tokenize(state.q||'');
      let res = state.data.filter(it=>{
        // basic text match
        const blob = `${it.name} ${it.desc} ${it.icon} ${it.type} ${it.rarity} ${it.collection} ${it.id}`.toLowerCase();
        const textOk = tokens.every(t=> blob.includes(t));
        // tags
        const idOk = tags.id ? String(it.id).includes(tags.id) : true;
        const iconOk = tags.icon ? String(it.icon).toLowerCase().includes(tags.icon) : true;
        // filters
        const rarOk = state.filters.rarity.size ? state.filters.rarity.has(it.rarity) : true;
        const typOk = state.filters.type.size ? state.filters.type.has(it.type) : true;
        const colOk = state.filters.collection.size ? state.filters.collection.has(it.collection) : true;
        return textOk && idOk && iconOk && rarOk && typOk && colOk;
      });

      // sort
      res = res.sort((a,b)=>{
        switch(state.sort){
          case 'name_asc': return a.name.localeCompare(b.name);
          case 'name_desc': return b.name.localeCompare(a.name);
          case 'rarity': return rarityRank(b.rarity) - rarityRank(a.rarity);
          case 'newest': return (b.id||0) - (a.id||0);
          default: // relevance: simple score by occurrences
            const score = (it)=>{
              const blob = `${it.name} ${it.desc} ${it.icon}`.toLowerCase();
              let s=0; tokens.forEach(t=>{ if(blob.includes(t)) s+=1; }); s+=rarityRank(it.rarity)/10; return s;
            };
            return score(b)-score(a);
        }
      })
      return res;
    }

    function paginate(arr){
      const start = (state.page-1)*state.pageSize;
      return arr.slice(start, start+state.pageSize);
    }

    function renderGrid(items){
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      items.forEach(it=>{
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="thumb"><img loading="lazy" src="${it.image||'https://picsum.photos/seed/placeholder/600/600'}" alt="${it.name}"/></div>
          <div class="meta">
            <div class="name">${it.name}</div>
            <div class="muted">#${it.id} • ${it.type}</div>
            <div class="pill">${it.rarity}${it.collection ? ' • '+it.collection : ''}</div>
          </div>
        `;
        card.addEventListener('click', ()=> openModal(it));
        grid.appendChild(card);
      })
    }

    function renderPagination(total){
      const pages = Math.max(1, Math.ceil(total / state.pageSize));
      const cont = document.getElementById('pagination');
      cont.innerHTML = '';
      const make = (p, label=p) => {
        const btn = document.createElement('button');
        btn.className = 'page-btn'+(p===state.page?' active':'');
        btn.textContent = label;
        btn.onclick = ()=>{ state.page = p; render(); };
        return btn;
      }
      cont.appendChild(make(Math.max(1, state.page-1), 'Prev'));
      // windowed pages
      const win = 4; const start = Math.max(1, state.page - win); const end = Math.min(pages, state.page + win);
      for(let p=start;p<=end;p++) cont.appendChild(make(p));
      cont.appendChild(make(Math.min(pages, state.page+1), 'Next'));
    }

    function openModal(it){
      $('#mName').textContent = it.name;
      $('#mDesc').textContent = it.desc || '';
      $('#mId').textContent = it.id;
      $('#mIcon').textContent = it.icon || '-';
      $('#mType').textContent = it.type || '';
      $('#mRare').textContent = it.rarity || '';
      $('#mColl').textContent = it.collection || '';
      $('#modalImg').src = it.image || 'https://picsum.photos/seed/placeholder/800/800';
      $('#modal').classList.add('open');
    }

    function wireModal(){
      $('#closeModal').onclick = ()=> $('#modal').classList.remove('open');
      $('#modal').addEventListener('click', (e)=>{ if(e.target.id==='modal') $('#modal').classList.remove('open'); })
    }

    function toggleSidebar(){
      const btn = document.getElementById('toggleSidebar');
      const aside = document.getElementById('sidebar');
      if(window.matchMedia('(max-width: 960px)').matches){
        aside.style.display = 'none';
      }
      btn.onclick = ()=>{
        const vis = getComputedStyle(aside).display !== 'none';
        aside.style.display = vis ? 'none' : 'block';
      }
      // auto show on desktop
      const mq = window.matchMedia('(min-width: 961px)');
      const apply = ()=>{ aside.style.display = mq.matches ? 'block' : 'none'; }
      mq.addEventListener('change', apply); apply();
    }

    function render(){
      applyActiveChipStyles();
      activeTabs();
      const results = searchAndFilter();
      const pageItems = paginate(results);
      renderGrid(pageItems);
      renderPagination(results.length);
      // hide loader
      document.getElementById('loadingDot').style.display = 'none';
    }

    // init
loadData();
buildChips();
buildSortAndPage();
syncSearchBoxes();
wireModal();
toggleSidebar();
render();
</script>
</body>
</html>
